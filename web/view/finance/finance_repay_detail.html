<!-- 主菜单：财务管理 -> 金融还款（详情） 画面 -->

<!-- 返回前画面 按钮 -->
<div class="row valign-wrapper">
    <a class="btn-floating btn waves-effect cyan lighten-1 waves-light" ng-click="return()">
        <i class="mdi mdi-arrow-left-bold"></i>
    </a>
    <h5 class="col s12 cyan-text lighten-1  center-align">还款详情</h5>
</div>

<div class="row">
    <div class="divider  cyan lighten-2" style="height:2px"></div>
</div>

<!-- 主画面 -->
<div class="row no-marBottom" ul-tabs>

    <!-- TAB -->
    <div class="col s12 p0" style="width: 96%; margin:0 2%">
        <ul class="tabWrap grey lighten-4 ">
            <li class="tab col s4 vc-center paymentInfoDiv"   ng-click="lookPaymentInfo(newPayment.repaymentId)">基本信息</li>
            <li class="tab col s4 vc-center creditPaymentDiv" ng-click="lookCreditPayment()">信用证还款</li>
            <li class="tab col s4 vc-center otherPaymentDiv"  ng-click="lookOtherPayment()">其他方式还款</li>
        </ul>
    </div>

    <!-- TAB [基本信息] -->
    <div id="paymentInfoDiv" class="tab_box">
        <div style="min-height: 480px;">
            <!-- 第一部分 -->

            <!-- 未还金额 起始时间 (只读) -->
            <div class="col s12 vc-center fz14" style="margin-top: 20px;margin-bottom: 20px;">
                <div class="col s6 left-align blue-grey lighten-5 cyan-text" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-right: 0">
                    未还金额(美元): <span class="red-text">{{paymentInfo.leftPaymentMoney | number}}</span>
                </div>
                <div class="col s6 right-align blue-grey lighten-5 grey-text" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-left: 0">
                    起始时间: {{paymentInfo.loanStartDate |date:'yyyy-MM-dd hh:mm'}}
                </div>
            </div>

            <!-- 还款编号 还款时间 (只读) -->
            <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;">
                <div class="col s6 left-align" style="height:44px; padding-top: 10px;">
                    还款编号: {{newPayment.repaymentId}}
                </div>
                <div class="col s6 right-align grey-text" style="height:44px; padding-top: 10px;">
                    还款时间: {{newPayment.repaymentDate |date:'yyyy-MM-dd hh:mm'}}
                </div>
            </div>
            <!-- 分割线 -->
            <div class="col divider" style="width:96%; margin-left: 20px;margin-bottom: 5px;"></div>

            <!-- 第二部分 -->
            <!-- 基本信息 (录入) -->
            <!-- 新增还款 或者 该条还款信息未完结时 (可修改) -->
            <div>
                <div class="col s12" style="margin-bottom: 5px;">
                    <!-- 本次还贷金额(美元) -->
                    <div class="input-field col s4">
                        <input type="text" id="paymentMoneyText" maxlength="10" valid-money ng-model="newPayment.paymentMoney" class="red-text right-align" ng-change="calculatePaymentMoney()">
                        <label for="paymentMoneyText"><span class="red-text">*</span>本次还贷金额(美元)</label>
                    </div>

                    <!-- 利率/天 -->
                    <div class="input-field col s4">
                        <input type="text" id="rateText" maxlength="10" valid-money ng-model="newPayment.rate" class="red-text right-align" ng-change="calculateInterest()">
                        <i class="dataIcon" style="right: -1px"> %</i>
                        <label for="rateText" ng-class="{'label-active':newPayment.rate !== ''}">利率/天</label>
                    </div>

                    <!-- 产生利息金额(美元) -->
                    <div class="input-field col s4">
                        <input type="text" id="principalText" maxlength="10" valid-money ng-model="newPayment.principal" class="red-text right-align" disabled>
                        <label for="principalText" ng-class="{'label-active':newPayment.principal !== ''}">产生利息金额(美元)</label>
                    </div>
                </div>

                <div class="col s12">
                    <!-- 产生利息时长(天) -->
                    <div class="input-field col s4">
                        <input type="text" id="interestDayText" maxlength="10" valid-num ng-model="newPayment.interestDay" class="right-align" ng-change="calculateInterest()">
                        <label for="interestDayText" ng-class="{'label-active':newPayment.interestDay !== ''}">
                            <span class="red-text">*</span>产生利息时长(天)
                        </label>
                    </div>

                    <!-- 利息(美元) -->
                    <div class="input-field col s4">
                        <input type="text" id="interestText" maxlength="10" valid-money ng-model="newPayment.interest" class="red-text right-align" disabled>
                        <label for="interestText" ng-class="{'label-active':newPayment.interest !== ''}">利息(美元)</label>
                    </div>

                    <!-- 手续费(美元) -->
                    <div class="input-field col s4">
                        <input type="text" id="poundageText" maxlength="10" valid-money ng-model="newPayment.poundage" class="red-text right-align" ng-change="calculatePaymentMoney()">
                        <label for="poundageText" ng-class="{'label-active':newPayment.poundage !== ''}">手续费(美元)</label>
                    </div>
                </div>

                <!-- 本次应还总额(美元) 剩余未还金额(美元) (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;">
                    <div class="col s6 left-align" style="height:44px; padding-top: 10px;">
                        本次应还总额(美元): <span class="red-text">{{newPayment.totalPaymentMoney | number}}</span>
                    </div>
                    <div class="col s6 right-align" style="height:44px; padding-top: 10px;">
                        剩余未还金额(美元): <span class="red-text">{{newPayment.leftPaymentMoney | number}}</span>
                    </div>
                </div>
                <!-- 分割线 -->
                <div class="col divider" style="width:96%; margin-left: 20px;margin-bottom: 5px;"></div>

                <!-- 备注 -->
                <div class="col s12">
                    <div class="input-field col s12">
                        <input type="text" id="paymentRemarkText" maxlength="200" ng-model="newPayment.remark">
                        <label for="paymentRemarkText">备注</label>
                    </div>
                </div>
            </div>

            <!-- 贷出信息完结 或者 该条还款信息完结时，全部表示项 (只读) -->
            <div >
                <div class="col s12" style="height:44px;">
                    <!-- 本次还贷金额(美元) -->
                    <div class="input-field col s4">
                        <label class="grey-text"><span class="fz14">本次还贷金额(美元)：</span><span class="red-text">{{newPayment.paymentMoney| number}}</span></label>
                    </div>

                    <!-- 利率/天 -->
                    <div class="input-field col s4">
                        <label class="grey-text"><span class="fz14">利率/天：{{newPayment.rate}}%</span></label>
                    </div>

                    <!-- 产生利息金额(美元) -->
                    <div class="input-field col s4">
                        <label class="grey-text"><span class="fz14">产生利息金额(美元)：</span><span class="red-text">{{newPayment.principal| number}}</span></label>
                    </div>
                </div>
                <!-- 分割线 -->
                <div class="col divider" style="width:96%; margin-left: 20px;margin-top: 20px;"></div>

                <div class="col s12" style="height:44px;">
                    <!-- 产生利息时长(天) -->
                    <div class="input-field col s4">
                        <label class="grey-text"><span class="fz14">产生利息时长(天)：{{newPayment.interestDay| number}}</span></label>
                    </div>

                    <!-- 利息(美元) -->
                    <div class="input-field col s4">
                        <label class="grey-text"><span class="fz14">利息(美元)：</span><span class="red-text">{{newPayment.interest| number}}</span></label>
                    </div>

                    <!-- 手续费(美元) -->
                    <div class="input-field col s4">
                        <label class="grey-text"><span class="fz14">手续费(美元)：</span><span class="red-text">{{newPayment.poundage| number}}</span></label>
                    </div>
                </div>
                <!-- 分割线 -->
                <div class="col divider" style="width:96%; margin-left: 20px;margin-top: 20px;"></div>

                <!-- 备注 -->
                <div class="col s12" style="height:44px;">
                    <div class="input-field col s12">
                        <label class="grey-text"><span class="fz14">备注：</span>{{newPayment.remark}}</label>
                    </div>
                </div>
                <!-- 分割线 -->
                <div class="col divider" style="width:96%; margin-left: 20px;margin-top: 20px;"></div>
            </div>

            <!-- 第三部分 -->
            <!-- 非新增还款(点击还款记录 查看详细按钮) -->
            <div >
                <!-- 本次应还总额(美元) 信用证还款金额(美元) 其他方式还款金额 (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;">
                    <div class="col s4 left-align" style="height:44px; padding-top: 10px;">
                        本次应还总额(美元): <span class="red-text">{{newPayment.totalPaymentMoney | number}}</span>
                    </div>
                    <div class="col s4 left-align" style="height:44px; padding-top: 10px;">
                        信用证还款金额(美元): <span class="red-text">{{newPayment.creditRepMoney | number}}</span>
                    </div>
                    <div class="col s4 left-align" style="height:44px; padding-top: 10px;">
                        其他方式还款金额(美元): <span class="red-text">{{newPayment.otherRepMoney | number}}</span>
                    </div>
                </div>
                <!-- 信用证还款金额(美元) 其他方式还款金额 (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;">
                    <div class="col s6 left-align" style="height:44px; padding-top: 10px;">
                        信用证还款金额(美元): <span class="red-text">{{newPayment.creditRepMoney | number}}</span>
                    </div>
                    <div class="col s6 right-align" style="height:44px; padding-top: 10px;">
                        其他方式还款金额(美元): <span class="red-text">{{newPayment.otherRepMoney | number}}</span>
                    </div>
                </div>
                <!-- 分割线 -->
                <div class="col divider" style="width:96%; margin-left: 20px;margin-bottom: 5px;"></div>
                <!-- 本次还款总金额(美元) (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;">
                    <div class="col s4 right-align" style="height:44px; padding-top: 10px;">
                        本次还款总金额(美元): <span class="red-text">{{newPayment.totalPaymentMoney | number}}</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- TAB [信用证还款] -->
    <div id="creditPaymentDiv" class="tab_box">
        <div style="min-height: 480px;">

            <!-- 新增还款 或者 该条还款信息未完结时 (可修改) -->
            <div >
                <!-- 本次应还总金额 本还金额 (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;margin-bottom: 20px;">
                    <div class="col s6 left-align blue-grey lighten-5" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-right: 0">
                        本次应还总金额(美元): <span class="red-text">{{creditPayment.totalPaymentMoney | number}}</span>
                    </div>
                    <div class="col s6 right-align blue-grey lighten-5" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-left: 0">
                        未还金额(美元): <span class="red-text">{{creditPayment.leftPaymentMoney | number}}</span>
                    </div>
                </div>

                <!-- 信用证号 -->
                <div class="col s12">
                    <div class="col s12 z-depth-1" style="border:1px solid lightgrey" style="margin-top: 20px;margin-bottom: 20px;height: 200px;">
                        <div class="input-field col s12" style="margin-top: 30px;margin-bottom: 20px;">
                            <input type="text" id="newCreditIdText" ng-model="newCreditId" >
                            <a ng-click="addCreditPayment()" class="dataIcon btn-floating cyan" style="width:20px;height: 20px;">
                                <i class="mdi mdi-plus" style="position: absolute;right:0px;bottom:0px;font-size:15px;line-height: 20px;"></i>
                            </a>
                            <label for="newCreditIdText" class="active" style="padding-left: 2px;">信用证号</label>
                        </div>
                    </div>
                </div>

                <!-- 已还金额 (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;margin-bottom: 20px;">
                    <div class="col s6"></div>
                    <div class="col s6 right-align" style="height:50px; padding-top: 15px;">
                        已还金额(美元): <span class="red-text">{{creditPayment.paymentMoney | number}}</span>
                    </div>
                </div>
            </div>

            <!-- 贷出信息完结 或者 该条还款信息完结时，全部表示项 (只读) -->
            <div >
                <!-- 本次应还总金额 本还金额 (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;margin-bottom: 20px;">
                    <div class="col s6 left-align blue-grey lighten-5" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-right: 0">
                        本次应还总金额(美元): <span class="red-text">{{creditPayment.totalPaymentMoney | number}}</span>
                    </div>
                    <div class="col s6 right-align blue-grey lighten-5" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-left: 0">
                        信用证还款金额(美元): <span class="red-text">{{creditPayment.paymentMoney | number}}</span>
                    </div>
                </div>
                <!-- 信用证还款金额(美元) (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;margin-bottom: 20px;">
                    <div class="col s6 left-align" style="height:50px; padding-top: 15px;">
                    </div>
                    <div class="col s6 right-align" style="height:50px; padding-top: 15px;">
                        信用证还款金额(美元): <span class="red-text">{{creditPayment.paymentMoney | number}}</span>
                    </div>
                </div>
                <div class="vc-center grey-text fz15" style="width: 100%;height: 300px;">
                    <i class="mdi mdi-alert-circle-outline" style="color: red;font-size: 30px"></i>
                    <span style="margin-left: 10px;">暂无信用证还款信息！</span>
                </div>
            </div>

            <!-- 信用证还款列表 区域 -->
            <div class="col s12">
                <ul class="collapsible" data-collapsible="accordion" collapsible>

                    <!-- 信用证 遍历 -->
                    <li ng-repeat="el in loanRepCreditRelList">

                        <!-- 信用证 详细列表 标题栏 -->
                        <div ng-click="getCreditCarRel($event,el.credit_id)" class="collapsible-header blue-grey lighten-5 grey-text text-darken-1 row no-mp fz14">
                            <div class="col left-align cyan-text" style="width:20%;">
                                信用证号：{{el.credit_number}}
                            </div>

                            <div class="col left-align" style="width:24%;">
                                信用证金额(美元)：<span class="red-text">{{el.credit_money | number}}</span>
                            </div>
                            <div class="col left-align" style="width:28%;">
                                实际到款金额(美元)：<span class="red-text">{{el.actual_money | number}}</span>
                            </div>

                            <div class="col left-align" style="width:16%;">
                                {{el.credit_created_date |date:'yyyy-MM-dd hh:mm'}}
                            </div>

                            <div class="col right-align cyan-text" style="width:12%;">
                                关联车辆
                                <span class="mdi mdi-close red-text" ng-click="deleteCreditPayment($event, el.credit_id)" style="margin-left: 3px;"></span>
                            </div>
                        </div>

                        <!-- 车辆品牌 详细列表 主体内容(初期为隐藏) -->
                        <div class="collapsible-body fz14" style="padding: 0">
                            <!-- （车辆品牌 -> 品牌类型）详细画面 -->
                            <div style="padding: 1rem;overflow: hidden">
                                <table class="bordered">
                                    <tbody>
                                    <tr ng-repeat="el in creditCarRelList" class="grey-text text-darken-1" style="height:30px">
                                        <td style="width:25%;">VIN码：{{el.vin}}</td>
                                        <td style="width:25%;">{{el.make_name}}/{{el.model_name}}</td>
                                        <td style="width:25%;">{{el.pro_date |date:'yyyy-MM-dd'}}</td>
                                        <td class="red-text right-align" style="width:25%;">{{el.valuation|currency}}</td>
                                    </tr>
                                    <tr class="grey-text text-darken-1" ng-if="creditCarRelList.length == 0">
                                        <td colspan="4" style="letter-spacing: 2px;text-align: center;">暂无数据</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- TAB [其他方式还款] -->
    <div id="otherPaymentDiv" class="tab_box">
        <div style="min-height: 480px;">

            <!-- 新增还款 或者 该条还款信息未完结时 (可修改) -->
            <div >
                <!-- 本次应还总金额 本还金额 (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;margin-bottom: 20px;">
                    <div class="col s6 left-align blue-grey lighten-5" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-right: 0">
                        本次应还总金额(美元): <span class="red-text">{{otherPayment.totalPaymentMoney | number}}</span>
                    </div>
                    <div class="col s6 right-align blue-grey lighten-5" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-left: 0">
                        未还金额(美元): <span class="red-text">{{otherPayment.leftPaymentMoney | number}}</span>
                    </div>
                </div>

                <!-- 支付编号 -->
                <div class="col s12">
                    <div class="col s12 z-depth-1" style="border:1px solid lightgrey" style="margin-top: 20px;margin-bottom: 20px;height: 200px;">
                        <div class="input-field col s12" style="margin-top: 30px;margin-bottom: 20px;">
                            <input type="text" id="newOtherPaymentIdText" ng-model="newOtherPaymentId" >
                            <a ng-click="addOtherPayment()" class="dataIcon btn-floating cyan" style="width:20px;height: 20px;">
                                <i class="mdi mdi-plus" style="position: absolute;right:0px;bottom:0px;font-size:15px;line-height: 20px;"></i>
                            </a>
                            <label for="newOtherPaymentIdText" class="active" style="padding-left: 2px;">支付编号</label>
                        </div>
                    </div>
                </div>

                <!-- 已还金额 (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;margin-bottom: 10px;">
                    <div class="col s6"></div>
                    <div class="col s6 right-align" style="height:50px; padding-top: 15px;">
                        已还金额(美元): <span class="red-text">{{otherPayment.paymentMoney | number}}</span>
                    </div>
                </div>
            </div>

            <!-- 贷出信息完结 或者 该条还款信息完结时，全部表示项 (只读) -->
            <div >
                <!-- 本次应还总金额 本还金额 (只读) -->
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;margin-bottom: 20px;">
                    <div class="col s6 left-align blue-grey lighten-5" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-right: 0">
                        本次应还总金额(美元): <span class="red-text">{{otherPayment.totalPaymentMoney | number}}</span>
                    </div>
                    <div class="col s6 right-align blue-grey lighten-5" style="height:50px; padding-top: 15px; border: 1px solid lightgrey;border-left: 0">
                        已还金额(美元): <span class="red-text">{{otherPayment.paymentMoney | number}}</span>
                    </div>
                </div>
                <div class="col s12 vc-center cyan-text fz14" style="margin-top: 20px;margin-bottom: 20px;">
                    <div class="col s6 left-align" style="height:50px; padding-top: 15px;">
                    </div>
                    <div class="col s6 right-align" style="height:50px; padding-top: 15px;">
                        已还金额(美元): <span class="red-text">{{otherPayment.paymentMoney | number}}</span>
                    </div>
                </div>
                <div class="vc-center grey-text fz15" style="width: 100%;height: 300px;">
                    <i class="mdi mdi-alert-circle-outline" style="color: red;font-size: 30px"></i>
                    <span style="margin-left: 10px;">暂无其他方式还款信息！</span>
                </div>
            </div>

            <!-- 其他方式还款列表 区域 -->
            <div class="col s12" ng-repeat="el in loanRepPaymentRelList" style="margin-bottom: 15px;">
                <div class="row z-depth-1">
                    <!-- header -->
                    <div class="col s12 lighten-1 cyan-text fz14 vc-center" style="height:40px;border:1px solid #bdbdbd;">
                        <div class="col s6 left-align">
                            支付编号：{{el.payment_id}}
                        </div>
                        <div class="col s6 right-align grey-text">
                            {{el.created_payment_date |date:'yyyy-MM-dd hh:mm'}}
                            <span ng-click="deleteOtherPayment($event, el.payment_id)"><i class="mdi mdi-close red-text right-align" style="padding-left:5px; cursor:pointer; right: 22px;"></i></span>
                        </div>
                    </div>

                    <div class="col s12 lighten-1 white grey-text vc-center fz14"  style="height:64px;border:1px solid #bdbdbd;border-top:0px solid #bdbdbd;">
                        <div class="col s4 left-align">
                            <span class="cyan-text">({{paymentType[el.payment_type-1].name}})</span>
                            <span style="margin-left: 5px;">{{el.number}}</span>
                        </div>
                        <div class="col s4 left-align">
                            金额(美元):<span class="red-text" style="margin-left: 10px;">{{el.payment_money | number}}</span>
                        </div>

                        <!-- 贷出信息完结 或者 该条还款信息完结时，全部表示项 (只读) -->
                        <div class="col s4 left-align cyan-text">
                            本次支付金额(美元):<span class="red-text" style="margin-left: 10px;">{{el.this_payment_money | number}}</span>
                        </div>

                        <!-- 新增还款 或者 该条还款信息未完结时 (可修改) -->
                        <div class="col s4 left-align">
                            <div class="col s10 input-field">
                                <input type="text" id="thisPaymentMoneyText" maxlength="10" valid-money ng-blur="calcTotalFees()" class="red-text" ng-model="el.this_payment_money">
                                <label for="thisPaymentMoneyText" class="active">本次支付金额(美元)</label>
                            </div>
                            <div class="col s2 left-align">
                                <a class="btn-floating waves-effect waves-light cyan lighten-1" style="left: 1px;width:30px;height: 30px;margin-top: 20px;" ng-click="updatePaymentMoney(el)">
                                    <i class="mdi mdi-check add_brand" style="position: absolute;right:0;bottom:3px;font-size:20px;line-height: 20px;"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>








</div>